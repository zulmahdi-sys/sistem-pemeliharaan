<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Pemeliharaan Fasilitas</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.min.js"></script>
    <style>
        /* Modern 3D Admin Dashboard */
        .admin-container {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #0f172a 0%, #1a1a1a 100%);
        }

        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(20, 30, 50, 0.95) 100%);
            color: white;
            padding: 2rem 0;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            backdrop-filter: blur(10px);
            border-right: 2px solid rgba(16, 185, 129, 0.2);
            box-shadow: 4px 0 20px rgba(0, 0, 0, 0.3);
            animation: slideInLeft 0.6s ease;
            z-index: 100;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .sidebar h3 {
            padding: 1rem 1.5rem;
            margin: 0;
            font-size: 1.2rem;
            border-bottom: 2px solid #10b981;
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, transparent 100%);
            font-weight: 900;
            letter-spacing: 0.5px;
            color: #ffffff;
        }

        .sidebar ul {
            list-style: none;
            padding: 1rem 0;
        }

        .sidebar li {
            margin: 0;
        }

        .sidebar a {
            display: block;
            padding: 1rem 1.5rem;
            color: white;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-left: 4px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .sidebar a::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: linear-gradient(180deg, #10b981, #34d399);
            transform: scaleY(0);
            transform-origin: top;
            transition: transform 0.3s ease;
        }

        .sidebar a:hover::before {
            transform: scaleY(1);
        }

        .sidebar a:hover,
        .sidebar a.active {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            border-left-color: white;
            transform: translateX(4px);
            box-shadow: 0 4px 16px rgba(16, 185, 129, 0.4);
            color: #ffffff;
        }

        .main-content {
            margin-left: 250px;
            flex: 1;
            background: linear-gradient(135deg, #0f172a 0%, #1a1a1a 100%);
            animation: slideInRight 0.6s ease;
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .admin-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1.5rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 8px 32px rgba(16, 185, 129, 0.3), 0 2px 8px rgba(0, 0, 0, 0.2);
            border-bottom: 2px solid rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(10px);
            animation: slideDown 0.6s ease;
        }

        .admin-header h1 {
            margin: 0;
            font-weight: 900;
            letter-spacing: -1px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            color: #ffffff;
        }

        .logout-btn {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .logout-btn:hover {
            background: linear-gradient(135deg, #c0392b 0%, #a93226 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.5);
        }

        .logout-btn:active {
            transform: translateY(0);
        }

        .content {
            padding: 2rem;
            animation: fadeIn 0.6s ease 0.3s both;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        .form-container {
            background: linear-gradient(135deg, rgba(25, 35, 65, 0.8) 0%, rgba(20, 30, 50, 0.8) 100%);
            padding: 2rem;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.2);
            backdrop-filter: blur(20px);
            animation: slideInUp 0.6s ease;
            position: relative;
            overflow: hidden;
        }

        .form-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #10b981, #34d399);
            animation: slideIn 0.8s ease 0.2s both;
        }

        .form-container h2 {
            color: #ffffff;
            margin-bottom: 1.5rem;
            font-weight: 900;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(16, 185, 129, 0.2);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            color: #e5e7eb;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            padding: 0.8rem;
            border: 2px solid rgba(16, 185, 129, 0.3);
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
            background: rgba(30, 40, 70, 0.6);
            color: #ffffff;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 4px rgba(16, 185, 129, 0.25);
            background: linear-gradient(135deg, rgba(40, 50, 80, 0.8) 0%, rgba(30, 40, 70, 0.8) 100%);
            transform: translateY(-2px);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid rgba(16, 185, 129, 0.2);
        }

        .btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .btn-submit {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            flex: 1;
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-submit:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.6);
        }

        .btn-reset {
            background: linear-gradient(135deg, rgba(75, 85, 115, 0.8) 0%, rgba(65, 75, 105, 0.8) 100%);
            color: #e5e7eb;
            border: 2px solid rgba(16, 185, 129, 0.3);
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-export {
            background: linear-gradient(135deg, #27ae60 0%, #229954 100%);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-export:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-export-pdf {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            box-shadow: 0 8px 20px rgba(231, 76, 60, 0.4);
        }

        .btn-export-pdf:hover {
            box-shadow: 0 12px 30px rgba(231, 76, 60, 0.6);
        }

        .btn-export-excel {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .btn-export-excel:hover {
            box-shadow: 0 12px 30px rgba(16, 185, 129, 0.6);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 2rem;
            background: linear-gradient(135deg, rgba(25, 35, 65, 0.8) 0%, rgba(20, 30, 50, 0.8) 100%);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 2px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.2);
            animation: slideInUp 0.6s ease 0.2s both;
            backdrop-filter: blur(10px);
        }

        .data-table thead {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .data-table th {
            padding: 1rem;
            text-align: left;
            font-weight: bold;
            color: #ffffff;
        }

        .data-table td {
            padding: 1rem;
            border-bottom: 1px solid rgba(16, 185, 129, 0.2);
            color: #e5e7eb;
        }

        .data-table tbody tr:hover {
            background: linear-gradient(90deg, rgba(16, 185, 129, 0.15) 0%, transparent 100%);
            transform: translateX(4px);
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .btn-delete:hover {
            background: #c0392b;
            box-shadow: 0 4px 12px rgba(231, 76, 60, 0.4);
            transform: translateY(-2px);
        }

        .success-message {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(52, 211, 153, 0.1) 100%);
            color: #a7f3d0;
            padding: 1rem;
            border-radius: 5px;
            margin-bottom: 1rem;
            display: none;
            border: 1px solid rgba(16, 185, 129, 0.3);
        }

        .export-buttons {
            margin-top: 2rem;
            display: flex;
            gap: 1rem;
        }

        @media (max-width: 768px) {
            .admin-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }

            .main-content {
                margin-left: 0;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .admin-header {
                flex-direction: column;
                gap: 1rem;
            }

            .form-buttons,
            .export-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <h3>ğŸ“Š Admin Panel</h3>
            <ul>
                <li><a href="index.html" style="background: #667eea;">ğŸ  Kembali ke HOME</a></li>
                <li><a href="#" onclick="showTab('pengumuman')" class="menu-link">ğŸ“¢ Pengumuman</a></li>
                <li><a href="#" onclick="showTab('agenda')" class="menu-link">ğŸ“… Agenda Kerja</a></li>
                <li><a href="#" onclick="showTab('listrik')" class="menu-link active">âš¡ Jaringan Listrik</a></li>
                <li><a href="#" onclick="showTab('air-bersih')" class="menu-link">ğŸ’§ Air Bersih</a></li>
                <li><a href="#" onclick="showTab('air-kotor')" class="menu-link">ğŸš° Air Kotor</a></li>
                <li><a href="#" onclick="showTab('ac')" class="menu-link">â„ï¸ Perbaikan AC</a></li>
                <li><a href="#" onclick="showTab('kendaraan')" class="menu-link">ğŸš— Kendaraan Dinas</a></li>
                <li><a href="#" onclick="showTab('gallery')" class="menu-link">ğŸ“· Gallery Dokumentasi</a></li>
                	<li><a href="#" onclick="openGalleryUpload()" class="menu-link">â• Upload Dokumentasi</a></li>
                <li><a href="#" onclick="logout()" style="color: #e74c3c; border-left-color: #e74c3c;">ğŸšª Logout</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="admin-header">
                <h1>Dashboard Admin - Pemeliharaan Fasilitas</h1>
                <div>
                    <span id="adminUsername" style="margin-right: 1rem;"></span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="content">
                <!-- Tab Pengumuman -->
                <div id="pengumuman" class="tab-content">
                    <div class="form-container">
                        <h2>ğŸ“¢ Input Pengumuman</h2>
                        <div class="success-message" id="pengumumanSuccess" style="display: none;">âœ“ Pengumuman berhasil disimpan!</div>
                        <div class="error-message" id="pengumumanError" style="display: none;"></div>
                        <form id="formPengumuman" onsubmit="submitForm(event, 'pengumuman')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_pengumuman">ğŸ“… Tanggal Pengumuman</label>
                                    <input type="date" id="tgl_pengumuman" required class="form-input">
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="judul_pengumuman">ğŸ“ Judul Pengumuman</label>
                                    <input type="text" id="judul_pengumuman" required placeholder="Masukkan judul pengumuman..." class="form-input">
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="isi_pengumuman">ğŸ“„ Isi Pengumuman</label>
                                    <textarea id="isi_pengumuman" required placeholder="Masukkan isi pengumuman lengkap..." class="form-input" style="min-height: 150px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Pengumuman</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Daftar Pengumuman</h3>
                        <table class="data-table" id="tabelPengumuman">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Judul</th>
                                    <th>Isi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelPengumuman">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('pengumuman')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('pengumuman')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Agenda -->
                <div id="agenda" class="tab-content">
                    <div class="form-container">
                        <h2>ğŸ“… Input Agenda Kerja</h2>
                        <div class="success-message" id="agendaSuccess" style="display: none;">âœ“ Agenda berhasil disimpan!</div>
                        <div class="error-message" id="agendaError" style="display: none;"></div>
                        <form id="formAgenda" onsubmit="submitForm(event, 'agenda')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_agenda">ğŸ“… Tanggal Agenda</label>
                                    <input type="date" id="tgl_agenda" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jam_agenda">â° Jam Mulai</label>
                                    <input type="time" id="jam_agenda" required class="form-input">
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="judul_agenda">ğŸ“ Judul Agenda</label>
                                    <input type="text" id="judul_agenda" required placeholder="Masukkan judul agenda..." class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="pic_agenda">ğŸ‘¤ PIC (Person In Charge)</label>
                                    <input type="text" id="pic_agenda" required placeholder="Nama penanggung jawab..." class="form-input">
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="keterangan_agenda">ğŸ“„ Keterangan Agenda</label>
                                    <textarea id="keterangan_agenda" placeholder="Keterangan tambahan (opsional)..." class="form-input" style="min-height: 120px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Agenda</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Daftar Agenda Kerja</h3>
                        <table class="data-table" id="tabelAgenda">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Jam</th>
                                    <th>Judul</th>
                                    <th>PIC</th>
                                    <th>Keterangan</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelAgenda">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('agenda')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('agenda')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Jaringan Listrik -->
                <div id="listrik" class="tab-content active">
                    <div class="form-container">
                        <h2>âš¡ Input Pemeliharaan Jaringan Listrik</h2>
                        <div class="success-message" id="listrikSuccess" style="display: none;">âœ“ Data berhasil disimpan!</div>
                        <div class="error-message" id="listrikError" style="display: none;"></div>
                        <form id="formListrik" onsubmit="submitForm(event, 'listrik')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_listrik">ğŸ“… Tanggal Pemeliharaan</label>
                                    <input type="date" id="tgl_listrik" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="teknisi_listrik">ğŸ‘¨â€ğŸ”§ Nama Teknisi</label>
                                    <input type="text" id="teknisi_listrik" required placeholder="Masukkan nama teknisi" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="lokasi_listrik">ğŸ“ Lokasi Perbaikan</label>
                                    <input type="text" id="lokasi_listrik" required placeholder="Contoh: Ruang Server, Panel Utama, dll" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jenis_kerusakan_listrik">âš ï¸ Jenis Kerusakan</label>
                                    <select id="jenis_kerusakan_listrik" required class="form-input">
                                        <option value="">-- Pilih jenis kerusakan --</option>
                                        <option value="Putus">Putus</option>
                                        <option value="Hubung Singkat">Hubung Singkat</option>
                                        <option value="Korsleting">Korsleting</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="deskripsi_listrik">ğŸ“ Deskripsi Perbaikan</label>
                                    <textarea id="deskripsi_listrik" required placeholder="Jelaskan detail perbaikan yang dilakukan..." class="form-input" style="min-height: 120px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Data</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Data Pemeliharaan Jaringan Listrik</h3>
                        <table class="data-table" id="tabelListrik">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Teknisi</th>
                                    <th>Lokasi</th>
                                    <th>Jenis Kerusakan</th>
                                    <th>Deskripsi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelListrik">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('listrik')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('listrik')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Air Bersih -->
                <div id="air-bersih" class="tab-content">
                    <div class="form-container">
                        <h2>ğŸ’§ Input Pemeliharaan Jaringan Air Bersih</h2>
                        <div class="success-message" id="airBersihSuccess" style="display: none;">âœ“ Data berhasil disimpan!</div>
                        <div class="error-message" id="airBersihError" style="display: none;"></div>
                        <form id="formAirBersih" onsubmit="submitForm(event, 'air-bersih')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_air_bersih">ğŸ“… Tanggal Pemeliharaan</label>
                                    <input type="date" id="tgl_air_bersih" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="teknisi_air_bersih">ğŸ‘¨â€ğŸ”§ Nama Teknisi</label>
                                    <input type="text" id="teknisi_air_bersih" required placeholder="Masukkan nama teknisi" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="lokasi_air_bersih">ğŸ“ Lokasi Pipa</label>
                                    <input type="text" id="lokasi_air_bersih" required placeholder="Contoh: Tangki Utama, Ruang Pompa, dll" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jenis_pekerjaan_air_bersih">ğŸ”§ Jenis Pekerjaan</label>
                                    <select id="jenis_pekerjaan_air_bersih" required class="form-input">
                                        <option value="">-- Pilih jenis pekerjaan --</option>
                                        <option value="Pembersihan Tangki">Pembersihan Tangki</option>
                                        <option value="Perbaikan Pipa">Perbaikan Pipa</option>
                                        <option value="Penggantian Pipa">Penggantian Pipa</option>
                                        <option value="Inspeksi">Inspeksi</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="deskripsi_air_bersih">ğŸ“ Deskripsi Pekerjaan</label>
                                    <textarea id="deskripsi_air_bersih" required placeholder="Jelaskan detail pekerjaan yang dilakukan..." class="form-input" style="min-height: 120px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Data</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Data Pemeliharaan Air Bersih</h3>
                        <table class="data-table" id="tabelAirBersih">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Teknisi</th>
                                    <th>Lokasi</th>
                                    <th>Jenis Pekerjaan</th>
                                    <th>Deskripsi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelAirBersih">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('air-bersih')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('air-bersih')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Air Kotor -->
                <div id="air-kotor" class="tab-content">
                    <div class="form-container">
                        <h2>ğŸš° Input Pemeliharaan Jaringan Air Kotor</h2>
                        <div class="success-message" id="airKotorSuccess" style="display: none;">âœ“ Data berhasil disimpan!</div>
                        <div class="error-message" id="airKotorError" style="display: none;"></div>
                        <form id="formAirKotor" onsubmit="submitForm(event, 'air-kotor')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_air_kotor">ğŸ“… Tanggal Pemeliharaan</label>
                                    <input type="date" id="tgl_air_kotor" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="teknisi_air_kotor">ğŸ‘¨â€ğŸ”§ Nama Teknisi</label>
                                    <input type="text" id="teknisi_air_kotor" required placeholder="Masukkan nama teknisi" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="lokasi_air_kotor">ğŸ“ Lokasi Saluran</label>
                                    <input type="text" id="lokasi_air_kotor" required placeholder="Contoh: Septik Tank, Saluran Drainase, dll" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jenis_pekerjaan_air_kotor">ğŸ”§ Jenis Pekerjaan</label>
                                    <select id="jenis_pekerjaan_air_kotor" required class="form-input">
                                        <option value="">-- Pilih jenis pekerjaan --</option>
                                        <option value="Pemompaan Septic Tank">Pemompaan Septic Tank</option>
                                        <option value="Pembersihan Saluran">Pembersihan Saluran</option>
                                        <option value="Perbaikan Saluran">Perbaikan Saluran</option>
                                        <option value="Inspeksi">Inspeksi</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="deskripsi_air_kotor">ğŸ“ Deskripsi Pekerjaan</label>
                                    <textarea id="deskripsi_air_kotor" required placeholder="Jelaskan detail pekerjaan yang dilakukan..." class="form-input" style="min-height: 120px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Data</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Data Pemeliharaan Air Kotor</h3>
                        <table class="data-table" id="tabelAirKotor">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Teknisi</th>
                                    <th>Lokasi</th>
                                    <th>Jenis Pekerjaan</th>
                                    <th>Deskripsi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelAirKotor">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('air-kotor')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('air-kotor')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab AC -->
                <div id="ac" class="tab-content">
                    <div class="form-container">
                        <h2>â„ï¸ Input Perbaikan AC (Pendingin Ruangan)</h2>
                        <div class="success-message" id="acSuccess" style="display: none;">âœ“ Data berhasil disimpan!</div>
                        <div class="error-message" id="acError" style="display: none;"></div>
                        <form id="formAC" onsubmit="submitForm(event, 'ac')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_ac">ğŸ“… Tanggal Perbaikan</label>
                                    <input type="date" id="tgl_ac" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="teknisi_ac">ğŸ‘¨â€ğŸ”§ Nama Teknisi</label>
                                    <input type="text" id="teknisi_ac" required placeholder="Masukkan nama teknisi" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="lokasi_ac">ğŸ“ Lokasi AC</label>
                                    <input type="text" id="lokasi_ac" required placeholder="Contoh: Ruang Server, Ruang Kantor, dll" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jenis_pekerjaan_ac">ğŸ”§ Jenis Pekerjaan</label>
                                    <select id="jenis_pekerjaan_ac" required class="form-input">
                                        <option value="">-- Pilih jenis pekerjaan --</option>
                                        <option value="Servis Berkala">Servis Berkala</option>
                                        <option value="Pembersihan Filter">Pembersihan Filter</option>
                                        <option value="Pengecekan Refrigeran">Pengecekan Refrigeran</option>
                                        <option value="Perbaikan Unit">Perbaikan Unit</option>
                                        <option value="Penggantian Komponen">Penggantian Komponen</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="deskripsi_ac">ğŸ“ Deskripsi Perbaikan</label>
                                    <textarea id="deskripsi_ac" required placeholder="Jelaskan detail perbaikan yang dilakukan..." class="form-input" style="min-height: 120px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Data</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Data Perbaikan AC</h3>
                        <table class="data-table" id="tabelAC">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Teknisi</th>
                                    <th>Lokasi</th>
                                    <th>Jenis Pekerjaan</th>
                                    <th>Deskripsi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelAC">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('ac')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('ac')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>
                </div>

                <!-- Tab Kendaraan Dinas -->
                <div id="kendaraan" class="tab-content">
                    <div class="form-container">
                        <h2>ğŸš— Input Penggunaan Kendaraan Dinas</h2>
                        <div class="success-message" id="kendaraanSuccess" style="display: none;">âœ“ Data berhasil disimpan!</div>
                        <div class="error-message" id="kendaraanError" style="display: none;"></div>
                        <form id="formKendaraan" onsubmit="submitForm(event, 'kendaraan')" class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tgl_kendaraan">ğŸ“… Tanggal Penggunaan</label>
                                    <input type="date" id="tgl_kendaraan" required class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="pengemudi">ğŸ‘¤ Nama Pengemudi</label>
                                    <input type="text" id="pengemudi" required placeholder="Masukkan nama pengemudi" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="no_polisi">ğŸ”– Nomor Polisi Kendaraan</label>
                                    <input type="text" id="no_polisi" required placeholder="Contoh: AB 1234 CD" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="jenis_kendaraan">ğŸš™ Jenis Kendaraan</label>
                                    <select id="jenis_kendaraan" required class="form-input">
                                        <option value="">-- Pilih jenis kendaraan --</option>
                                        <option value="Mobil">Mobil</option>
                                        <option value="Motor">Motor</option>
                                        <option value="Truk">Truk</option>
                                        <option value="Lainnya">Lainnya</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="tujuan">ğŸ¯ Tujuan Penggunaan</label>
                                    <input type="text" id="tujuan" required placeholder="Masukkan tujuan perjalanan" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="km_awal">â±ï¸ KM Awal</label>
                                    <input type="number" id="km_awal" required placeholder="Masukkan KM" class="form-input">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="km_akhir">â±ï¸ KM Akhir</label>
                                    <input type="number" id="km_akhir" required placeholder="Masukkan KM" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label for="durasi">â²ï¸ Durasi (Jam)</label>
                                    <input type="number" id="durasi" step="0.5" required placeholder="Durasi dalam jam" class="form-input">
                                </div>
                            </div>
                            <div class="form-row full">
                                <div class="form-group">
                                    <label for="keterangan_kendaraan">ğŸ“ Keterangan</label>
                                    <textarea id="keterangan_kendaraan" placeholder="Keterangan tambahan (opsional)" class="form-input" style="min-height: 100px;"></textarea>
                                </div>
                            </div>
                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">âœ“ Simpan Data</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <h3 style="margin-top: 3rem; color: #667eea;">Data Penggunaan Kendaraan Dinas</h3>
                        <table class="data-table" id="tabelKendaraan">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Tanggal</th>
                                    <th>Pengemudi</th>
                                    <th>No Polisi</th>
                                    <th>Jenis</th>
                                    <th>Tujuan</th>
                                    <th>KM</th>
                                    <th>Durasi</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="bodyTabelKendaraan">
                            </tbody>
                        </table>

                        <div class="export-buttons">
                            <button class="btn btn-export btn-export-pdf" onclick="exportPDF('kendaraan')">ğŸ“„ Export PDF</button>
                            <button class="btn btn-export btn-export-excel" onclick="exportExcel('kendaraan')">ğŸ“Š Export Excel</button>
                        </div>
                    </div>

                    <!-- Gallery Tab -->
                    <div id="gallery" class="tab-content">
                        <h2>ğŸ“· Gallery Dokumentasi Perbaikan Per Kelompok</h2>
                        
                        <!-- Tabs untuk kategori -->
                        <div style="display: flex; gap: 0.5rem; margin-bottom: 2rem; flex-wrap: wrap;">
                            <button class="gallery-cat-btn active" data-category="listrik" onclick="switchGalleryCategory(event)">âš¡ Listrik</button>
                            <button class="gallery-cat-btn" data-category="air-bersih" onclick="switchGalleryCategory(event)">ğŸ’§ Air Bersih</button>
                            <button class="gallery-cat-btn" data-category="air-kotor" onclick="switchGalleryCategory(event)">ğŸš° Air Kotor</button>
                            <button class="gallery-cat-btn" data-category="ac" onclick="switchGalleryCategory(event)">â„ï¸ AC</button>
                            <button class="gallery-cat-btn" data-category="kendaraan" onclick="switchGalleryCategory(event)">ğŸš— Kendaraan</button>
                        </div>

                        <!-- Form input gallery per kategori -->
                        <form id="formGalleryUpload" onsubmit="submitGalleryForm(event)" style="background: white; padding: 2rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                            <div id="galleryFormContent">
                                <!-- Content akan diisi dinamis per kategori -->
                            </div>

                            <!-- Upload Area dengan Drag & Drop -->
                            <div class="gallery-upload-area" id="galleryUploadArea">
                                <div class="upload-icon">ğŸ“¸</div>
                                <h4>Pilih atau Drag & Drop Gambar</h4>
                                <p style="color: #666; margin-bottom: 1.5rem;">Format: PNG, JPG, JPEG (Max 5MB)</p>
                                <input 
                                    type="file" 
                                    id="gallery_image" 
                                    name="gallery_image" 
                                    accept=".png,.jpg,.jpeg,image/png,image/jpeg" 
                                    style="display: none;"
                                    required
                                >
                                <button type="button" class="btn btn-upload" onclick="document.getElementById('gallery_image').click()">
                                    ğŸ–¼ï¸ Pilih File
                                </button>
                            </div>

                            <!-- Image Preview -->
                            <div id="imagePreview" style="display: none; margin: 1.5rem 0;">
                                <p style="color: #666; font-weight: 600; margin-bottom: 1rem;">Preview Gambar:</p>
                                <div style="position: relative; display: inline-block;">
                                    <img id="previewImage" src="" alt="Preview" style="max-width: 100%; max-height: 300px; border-radius: 8px; border: 2px solid #e5e7eb;">
                                    <button type="button" class="btn btn-remove" onclick="removeImagePreview()">âœ• Hapus</button>
                                </div>
                            </div>

                            <!-- File Info -->
                            <div id="fileInfo" style="display: none; background: #f0fdf4; padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #10b981;">
                                <p style="margin: 0.3rem 0; font-size: 0.9rem;"><strong>File:</strong> <span id="fileName"></span></p>
                                <p style="margin: 0.3rem 0; font-size: 0.9rem;"><strong>Ukuran:</strong> <span id="fileSize"></span></p>
                                <p style="margin: 0.3rem 0; font-size: 0.9rem;"><strong>Format:</strong> <span id="fileFormat"></span></p>
                            </div>

                            <div class="form-buttons">
                                <button type="submit" class="btn btn-submit">â• Unggah Dokumentasi</button>
                                <button type="reset" class="btn btn-reset">ğŸ”„ Reset</button>
                            </div>
                        </form>

                        <div id="gallerySuccess" style="display: none; background: #d4edda; color: #155724; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; border-left: 4px solid #28a745;">
                            âœ“ Dokumentasi berhasil ditambahkan!
                        </div>

                        <div id="galleryError" style="display: none; background: #f8d7da; color: #721c24; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; border-left: 4px solid #f5c6cb;">
                            âœ• <span id="errorMessage"></span>
                        </div>

                        <h3 style="margin-top: 2rem; margin-bottom: 1.5rem;">Dokumentasi Terbaru - <span id="categoryTitle">Jaringan Listrik</span></h3>
                        <div id="galleryPreview" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1.5rem;">
                            <p style="color: #999; grid-column: 1/-1;">Memuat dokumentasi...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>
